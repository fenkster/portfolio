---
title: "compmusic"
author: "fenk"
date: "Spring 2021"
output:
  pdf_document: default
  html_document: default
---
```{r}
library(tidyverse)
library(spotifyr)
```

```{r}
west <- get_playlist_audio_features("", "37i9dQZF1DX9sQDbOMReFI")
#west <- get_playlist_audio_features("", "6dv5FbNRVlQelteqnNDFTe")
#east <- get_playlist_audio_features("", "67zYW4wCQezR6AH8EuNZ1Q")
east <- get_playlist_audio_features("", "37i9dQZF1DWYGxBNe4qojI")

west_new <- get_playlist_audio_features("", "3X0Ds1IEYdG1DL0sxCuW6y")
east_new <- get_playlist_audio_features("", "37i9dQZF1DX1YPTAhwehsC")
```

```{r}
west_summary <- west %>%
  summarise(
    mean_popularity = mean(track.popularity),
    mean_danceability = mean(danceability),
    mean_valence = mean(valence),
    mean_energy = mean(energy),
    mean_acousticness = mean(acousticness),
  )
```

```{r}
east_summary <- east %>%
  summarise(
    mean_popularity = mean(track.popularity),
    mean_danceability = mean(danceability),
    mean_valence = mean(valence),
    mean_energy = mean(energy),
    mean_acousticness = mean(acousticness),
  )
```

```{r}
together <-
  bind_rows(
    west %>% mutate(category = "West Coast Classics"),
    east %>% mutate(category = "East Coast Classics"),
    west_new %>% mutate(category = "West Coast Modern"),
    east_new %>% mutate(category = "East Coast Modern")
  )
```

```{r}
west %>% ggplot(aes(x =valence)) + geom_histogram(binwidth = 0.05)
```

```{r}
east %>% ggplot(aes(x = valence)) + geom_histogram(binwidth = 0.05)
```

```{r}
together %>%                    
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) %>%
  ggplot(                     # Set up the plot.
    aes(
      x = valence,
      y = energy,
      size = liveness,
      colour = mode
    )
  ) + geom_point() +              # Scatter plot.
  #geom_rug(size = 0.1) +      # Add 'fringes' to show data distribution.
  # geom_text(                  # Add text labels from above.
  #   aes(
  #     x = valence,
  #     y = energy,
  #     label = label
  #   ),
  #   data = 
  #     tibble(
  #       label = c("Altijd wel iemand", "ENERGY"),
  #       category = c("00s", "70s"),
  #       valence = c(0.090, 0.123),
  #       energy = c(0.101, 0.967)
  #     ),
  #   colour = "black",         # Override colour (not mode here).
  #   size = 3,                 # Override size (not loudness here).
  #   hjust = "left",           # Align left side of label with the point.
  #   vjust = "bottom",         # Align bottom of label with the point.
  #   nudge_x = -0.05,          # Nudge the label slightly left.
  #   nudge_y = 0.02            # Nudge the label slightly up.
  # ) +
  facet_wrap(~category) +     # Separate charts per playlist.
  scale_x_continuous(         # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),   # Use grid-lines for quadrants only.
    minor_breaks = NULL       # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(         # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(        # Use the Color Brewer to choose a palette.
    type = "qual",            # Qualitative set.
    palette = "Paired",  # Name of the palette is 'Paired'.
    ) +
  scale_size_continuous(      # Fine-tune the sizes of each point.
     trans = "exp",            # Use an exp transformation to emphasise loud.
     #guide = "none"            # Remove the legend for size.
  ) +
  theme_light() +             # Use a simpler theme.
  labs(                       # Make the titles nice.
    x = "Valence",
    y = "Energy",
    colour = "Mode",
    size="Liveness"
  )
```

```{r}
together %>% ggplot(aes(x = mode)) + geom_histogram(binwidth = 0.05)+facet_wrap(~category)
```